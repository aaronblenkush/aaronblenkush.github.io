var Ke=Object.defineProperty;var Ce=(i,t,s)=>t in i?Ke(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var R=(i,t,s)=>(Ce(i,typeof t!="symbol"?t+"":t,s),s);import{s as xe,n as de,o as Ae,j as Me,b as qe,r as Te}from"./scheduler.bbae3d7e.js";import{S as Ie,i as Re,g as U,s as ce,h as j,j as G,c as fe,f as k,k as L,a as T,z as X,e as se,A as ue,y as Ee,r as Be,u as Fe,l as me,v as He,B as ie,d as Ne,t as Oe,w as Ge}from"./index.9784a31f.js";import{e as Y}from"./each.e59479a4.js";/* empty css            */function We(i,t,s=0){return Math.max(s,Math.min(t,i))}function ae(i,t=0){return Math.floor(Math.random()*(i-t))+t}function Je(i){let{key:t,code:s}=i,e=t=="i",l=t=="j",n=t=="k",r=t=="l",o=t=="w",d=t=="a",b=t=="s",x=t=="d",h=t=="ArrowUp",v=t=="ArrowDown",p=t=="ArrowRight",u=t=="ArrowLeft",y=h||v||p||u,z=o,V=b,S=x,M=d,E=z||V||S||M,q=e,c=n,D=r,A=l,B=q||c||D||A,$=h||o,K=v||b,I=p||x,C=u||d,F=$||K||I||C,H=s=="Space",W=s=="Enter",ne=s=="Insert",re=s=="Delete",a=s=="Home",f=s=="End",_=s=="PageUp",g=s=="PageDown",m=s=="Minus",w=s=="Equal",P=i.ctrlKey,J=i.altKey,N=i.shiftKey,O=s=="Backquote";return{arrow:y,arrowU:h,arrowD:v,arrowR:p,arrowL:u,keyW:o,keyA:d,keyS:b,keyD:x,dir:F,wasd:E,wasdD:V,wasdR:S,wasdL:M,wasdU:z,ijkl:B,ijklU:q,ijklD:c,ijklL:A,ijklR:D,dirU:$,dirD:K,dirR:I,dirL:C,space:H,enter:W,insert:ne,del:re,ctrl:P,alt:J,shift:N,code:s,home:a,end:f,pageU:_,pageD:g,minus:m,equal:w,tilde:O}}function Le(i,t=[]){let s=[...i],e=s.length;if(e==0)return t;let l=Math.floor(Math.random()*e),n=s.slice(0,l),r=s.slice(l,e),o=r.shift(),d=[...n,...r];return Le(d,[...t,o])}function ge(i,t,s){const e=i.slice();return e[36]=t[s],e[38]=s,e}function _e(i,t,s){const e=i.slice();return e[36]=t[s],e[40]=s,e}function pe(i,t,s){const e=i.slice();return e[41]=t[s][0],e[42]=t[s][1],e}function we(i){let t,s=Y([...new Array(Q)]),e=[];for(let l=0;l<s.length;l+=1)e[l]=be(ge(i,s,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=se()},l(l){for(let n=0;n<e.length;n+=1)e[n].l(l);t=se()},m(l,n){for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(l,n);T(l,t,n)},p(l,n){if(n[0]&56){s=Y([...new Array(Q)]);let r;for(r=0;r<s.length;r+=1){const o=ge(l,s,r);e[r]?e[r].p(o,n):(e[r]=be(o),e[r].c(),e[r].m(t.parentNode,t))}for(;r<e.length;r+=1)e[r].d(1);e.length=s.length}},d(l){l&&k(t),ue(e,l)}}}function ve(i){let t;return{c(){t=U("span"),this.h()},l(s){t=j(s,"SPAN",{class:!0}),G(t).forEach(k),this.h()},h(){L(t,"class","fa-solid text-green-900 fa-bug")},m(s,e){T(s,t,e)},d(s){s&&k(t)}}}function ye(i){let t,s,e=i[41]=="food"&&ve();return{c(){t=U("div"),e&&e.c(),this.h()},l(l){t=j(l,"DIV",{class:!0});var n=G(t);e&&e.l(n),n.forEach(k),this.h()},h(){L(t,"class",s=i[4][i[41]]+" square svelte-ztirnd")},m(l,n){T(l,t,n),e&&e.m(t,null)},p(l,n){l[41]=="food"?e||(e=ve(),e.c(),e.m(t,null)):e&&(e.d(1),e=null),n[0]&8&&s!==(s=l[4][l[41]]+" square svelte-ztirnd")&&L(t,"class",s)},d(l){l&&k(t),e&&e.d()}}}function ke(i){let t,s=Y([i[3]&&i[5](i[38],i[40])||[]]),e=[];for(let l=0;l<1;l+=1)e[l]=ye(pe(i,s,l));return{c(){for(let l=0;l<1;l+=1)e[l].c();t=se()},l(l){for(let n=0;n<1;n+=1)e[n].l(l);t=se()},m(l,n){for(let r=0;r<1;r+=1)e[r]&&e[r].m(l,n);T(l,t,n)},p(l,n){if(n[0]&56){s=Y([l[3]&&l[5](l[38],l[40])||[]]);let r;for(r=0;r<1;r+=1){const o=pe(l,s,r);e[r]?e[r].p(o,n):(e[r]=ye(o),e[r].c(),e[r].m(t.parentNode,t))}for(;r<1;r+=1)e[r].d(1)}},d(l){l&&k(t),ue(e,l)}}}function be(i){let t,s,e=Y([...new Array(Z)]),l=[];for(let n=0;n<e.length;n+=1)l[n]=ke(_e(i,e,n));return{c(){t=U("div");for(let n=0;n<l.length;n+=1)l[n].c();s=ce(),this.h()},l(n){t=j(n,"DIV",{class:!0});var r=G(t);for(let o=0;o<l.length;o+=1)l[o].l(r);s=fe(r),r.forEach(k),this.h()},h(){L(t,"class","flex flex-row -z-10")},m(n,r){T(n,t,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(t,null);X(t,s)},p(n,r){if(r[0]&56){e=Y([...new Array(Z)]);let o;for(o=0;o<e.length;o+=1){const d=_e(n,e,o);l[o]?l[o].p(d,r):(l[o]=ke(d),l[o].c(),l[o].m(t,s))}for(;o<l.length;o+=1)l[o].d(1);l.length=e.length}},d(n){n&&k(t),ue(l,n)}}}function De(i){let t,s='<i class="fa-solid fa-keyboard"></i> Arrow keys / WASD / Touch';return{c(){t=U("div"),t.innerHTML=s,this.h()},l(e){t=j(e,"DIV",{class:!0,"data-svelte-h":!0}),Ee(t)!=="svelte-d8iit8"&&(t.innerHTML=s),this.h()},h(){L(t,"class","absolute bottom-8 z-40 text-black/40 dark:text-white/30 text-2xl sm:w-[512px] px-12 text-center")},m(e,l){T(e,t,l)},d(e){e&&k(t)}}}function Xe(i){let t,s,e,l=i[2]&&we(i),n=i[1]&&De();return{c(){t=U("div"),s=U("div"),l&&l.c(),e=ce(),n&&n.c(),this.h()},l(r){t=j(r,"DIV",{class:!0});var o=G(t);s=j(o,"DIV",{class:!0});var d=G(s);l&&l.l(d),e=fe(d),n&&n.l(d),d.forEach(k),o.forEach(k),this.h()},h(){L(s,"class","flex-none block"),L(t,"class","snake mx-auto w-screen max-w-screen text-white svelte-ztirnd")},m(r,o){T(r,t,o),X(t,s),l&&l.m(s,null),X(s,e),n&&n.m(s,null),i[12](s)},p(r,o){r[2]?l?l.p(r,o):(l=we(r),l.c(),l.m(s,e)):l&&(l.d(1),l=null),r[1]?n||(n=De(),n.c(),n.m(s,null)):n&&(n.d(1),n=null)},i:de,o:de,d(r){r&&k(t),l&&l.d(),n&&n.d(),i[12](null)}}}let Ye=40,Q=20,Z=27;function oe([i,t],[s,e]){let l=i+s,n=t+e;return[l,n]}function te(i,t){let[[s,e],[l,n]]=[i,t];return s==l&&e==n}function Qe(i,t,s){let e,l=!0;function n(){return e}let r=-1,o=[...new Array(Q)].reduce((a,f,_)=>(a[_]=[...new Array(Z)].reduce((g,m,w)=>(r=r==-1?-2:-1,g[w]=r,g),[]),a),[]);function d(){let a=p<60?1:p<100?3:10;p=Math.max(Ye,p-a)}class b{constructor(f,_){R(this,"dir");R(this,"queue");R(this,"moves");R(this,"growth");R(this,"name");R(this,"score");R(this,"sections");R(this,"starting");R(this,"queuing");R(this,"gameover");this.name=f,this.starting=[..._],this.reset()}checkCollision(){let f=this.sections[0],[_,g]=f;for(let m=0;m<u.length;m++){let w=u[m].sections;for(let P=1;P<w.length;P++)if(te(f,w[P]))return!0}return _>Q-1||g>Z-1||_<0||g<0?!0:(h&&te(f,h)&&(this.growth++,A(),this.score++,d()),!1)}render(){if(this.gameover)return;let f=this.queue.shift();f&&(this.dir=f);let _=[...this.sections.slice(-1)[0]],g=[];for(let m=0;m<this.sections.length;m++)if(m==0){let w=[...this.dir],P=[...this.sections[m]];if(this.sections[m]=[...oe(this.sections[m],this.dir)],this.checkCollision()){let J=Le(D);for(let N=0;N<J.length;N++){let O=J[N];if(this.sections[m]=[...P],this.dir=[...w],!!H(this.dir,O)&&(this.sections[m]=oe(this.sections[m],O),this.dir=O,!this.checkCollision()))break}}this.moves.push(this.dir),g.push(this.dir)}else{let w=this.moves.shift()||this.dir;this.sections[m]=oe(this.sections[m],w),g.push(w)}this.growth>0&&(this.growth--,this.sections.push(_)),this.moves=[...g],this.queuing=!1}reset(){this.sections=[[...this.starting]],this.moves=[],this.growth=5,this.score=0,this.dir=c,this.queue=[],this.queuing=!1,this.gameover=!1}move(f,_=!1){if(s(1,l=_),this.gameover)return;this.queuing||(this.queue=[],this.queuing=!0);let g=this.queue.slice(-1)[0];H(g||this.dir,f)&&this.queue.push(f)}}let x,h,v,p,u,{options:y}=t;function z(){return h}function V(){return u[0]}function S(){let{numPlayers:a}=y;a=We((y==null?void 0:y.numPlayers)||1,3,1),x="PLAY",p=(y==null?void 0:y.delay)||250;let f="Bob",_="Tom",g="Jeb";s(3,u=[new b(f,[5,5]),new b(_,[8,5]),new b(g,[12,5])].slice(0,a)),A()}let M=[-1,0],E=[1,0],q=[0,-1],c=[0,1];const D=[M,E,q,c];function A(){h=[ae(Q,10),ae(Z)]}let B={food:"",b1:"dark:bg-gray-800 bg-green-800/10 fading",c1:"dark:bg-gray-800 bg-green-800/10",b2:"fading",c2:"",p1:"bg-red-500/90",p2:"bg-yellow-500",p3:"bg-blue-500",t1:"bg-red-800/90",t2:"bg-yellow-800",t3:"bg-blue-800"};function $(a,f){let _=o[a][f];for(let g=0;g<u.length;g++){let m=u[g].sections;for(let w=0;w<m.length;w++)if(te(m[w],[a,f]))return _<0&&s(2,o[a][f]=o[a][f]+2,o),[(w==0?"p":"t")+(g+1),w]}return h&&te(h,[a,f])?["food"]:_==-2?["c1"]:_==-1?["c2"]:_==0?["b1"]:["b2"]}function K(){x="GAME OVER"}function I(){x=="GAME OVER"||(u.map(a=>a.render()),u.every(a=>a.gameover)&&K(),s(3,u=[...u])),F(),C()}function C(){v=setInterval(()=>requestAnimationFrame(I),p)}function F(){v&&clearInterval(v)}Ae(()=>{S(),C()}),Me(()=>{F()});function H(a,f){return!(a==f||a==M&&f==E||a==E&&f==M||a==q&&f==c||a==c&&f==q)}function W(a){s(1,l=!0),u[0].move(a,!0)}function ne(a){let{arrow:f,arrowR:_,arrowL:g,arrowU:m,arrowD:w,wasd:P,wasdR:J,wasdL:N,wasdU:O,wasdD:Pe,ijkl:Ue,ijklR:je,ijklL:ze,ijklU:Ve,ijklD:nt,space:Se}=Je(a);if(Se)return x=="GAME OVER"&&S(),a.preventDefault(),!1;{let he=J?c:N?q:O?M:Pe?E:!1,ee=_?c:g?q:m?M:w?E:!1;if(ee&&u[2]&&(u[2].move(ee),a.preventDefault()),(u.length==1?he||ee:P&&u[0])&&(u[0].move(he||ee),a.preventDefault()),Ue&&u[1]){let $e=je?c:ze?q:Ve?M:E;u[1].move($e),a.preventDefault()}}}function re(a){qe[a?"unshift":"push"](()=>{e=a,s(0,e)})}return i.$$set=a=>{"options"in a&&s(7,y=a.options)},[e,l,o,u,B,$,n,y,z,V,W,ne,re]}class Ze extends Ie{constructor(t){super(),Re(this,t,Qe,Xe,xe,{getBoard:6,options:7,getFood:8,getPlayer:9,movePlayer:10,onKeydown:11},null,[-1,-1])}get getBoard(){return this.$$.ctx[6]}get getFood(){return this.$$.ctx[8]}get getPlayer(){return this.$$.ctx[9]}get movePlayer(){return this.$$.ctx[10]}get onKeydown(){return this.$$.ctx[11]}}function et(i){let t,s,e,l="",n,r,o,d,b,x={options:i[1]};return r=new Ze({props:x}),i[5](r),{c(){t=U("div"),s=U("div"),e=U("div"),e.innerHTML=l,n=ce(),Be(r.$$.fragment),this.h()},l(h){t=j(h,"DIV",{class:!0});var v=G(t);s=j(v,"DIV",{class:!0});var p=G(s);e=j(p,"DIV",{class:!0,"data-svelte-h":!0}),Ee(e)!=="svelte-60anrh"&&(e.innerHTML=l),n=fe(p),Fe(r.$$.fragment,p),p.forEach(k),v.forEach(k),this.h()},h(){L(e,"class","absolute w-full text-center mt-24 -z-30 mx-auto opacity-50 z-30 pt-12 fa-solid text-green-900 fa-bug"),me(e,"font-size","20cqw"),L(s,"class","transition-all duration-1000 mx-auto parallax w-screen max-w-screen svelte-f6ommp"),me(s,"zoom",.75),L(t,"class","overflow-hidden h-[650px] drop-shadow-2xl -z-30 w-screen max-w-screen ")},m(h,v){T(h,t,v),X(t,s),X(s,e),X(s,n),He(r,s,null),o=!0,d||(b=[ie(window,"keydown",i[2]),ie(window,"touchstart",i[4]),ie(window,"mousedown",i[3])],d=!0)},p(h,[v]){const p={};r.$set(p)},i(h){o||(Ne(r.$$.fragment,h),o=!0)},o(h){Oe(r.$$.fragment,h),o=!1},d(h){h&&k(t),i[5](null),Ge(r),d=!1,Te(b)}}}const tt=5,lt=750;function le(i,t){let[[s,e],[l,n]]=[i,t];return s==l&&e==n}function st(i,t,s){let e,l={players:1,delay:150},n;const r=[-1,0],o=[1,0],d=[0,-1],b=[0,1];function x(){v();let c=e.getPlayer(),D=[...c.dir],[A,B]=e.getFood(),[$,K]=c.sections[0];if(B!=K||A!=$){let I,C=le(D,r),F=le(D,o),H=le(D,b),W=le(D,d);(C||F)&&B<K?I=d:(C||F)&&B>K?I=b:(W||H)&&A<$?I=r:(W||H)&&A>$?I=o:I=D,e.movePlayer(I)}h()}function h(c){c||(c=ae(tt,lt)),n=setTimeout(x,c)}function v(){n&&clearInterval(n)}Ae(()=>{h()}),Me(()=>{v()});function p(c){e&&(e.onKeydown(c),v(),h(5e3))}let u,y,z,V;function S(c){let D=e.getBoard();[z,V,u,y]=[D.offsetWidth,D.offsetHeight,c.clientX,c.clientY].map(Math.round),console.log(c),console.log(u,y);let A=y<V*(1/2)?r:y>=V*(2/3)?o:u<z*(1/2)?d:u>=z*(1/2)?b:null;A&&(v(),h(5e3),e.getPlayer().move(A))}function M(c){S(c)}function E(c){S(c.touches[0])}function q(c){qe[c?"unshift":"push"](()=>{e=c,s(0,e)})}return[e,l,p,M,E,q]}class ft extends Ie{constructor(t){super(),Re(this,t,st,et,xe,{})}}export{ft as A};
